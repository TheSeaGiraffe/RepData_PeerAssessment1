---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Prior to the analysis, we must first load the data and clean it.

```{r message = FALSE}
# Load the necessary packages
library(tidyverse)
library(magrittr)
library(zeallot)

# Load the data
activity_data <- read_csv('activity.csv')

# Glimpse the unprocessed data
activity_data %>% glimpse()
```

Notice that the `date` column has already been converted into a `Datetime`
object by the `read_csv` function, so our data preprocessing has been handled
for us. We'll leave the `NA`s alone for now.

## What is mean total number of steps taken per day?

In order to obtain this value we need to obtain the total number of steps for
each day.

```{r}
# Get total number of steps per day
total_steps_per_day <- activity_data %>%
	group_by(date) %>%
	summarize(total_steps = sum(steps))

# Display the values
total_steps_per_day
```

Note the `NA`s. We will be explicitly ignoring them in our calculation of the
mean and median total steps taken per day. By this it is meant that the `NA`
values will be removed from the calculation.

```{r}
# Get the mean and median total steps
total_steps_per_day %>%
	summarize(mean_total_steps = mean(total_steps, na.rm = T),
			  median_total_steps = median(total_steps, na.rm = T))
```

In order to get a sense of the distribution of the total number of steps taken
each day, we'll create a histogram.

```{r message = FALSE, warning = FALSE, fig.align = 'center'}
# Histogram of the total steps taken per day
total_steps_per_day %>% ggplot(aes(total_steps)) +
	geom_histogram(color = 'black', fill = 'grey') + theme_bw() +
	labs(title = 'Histogram of the Total Number of Steps Per Day',
		 x = 'Steps', y = 'Frequency') +
	theme(plot.title = element_text(hjust = 0.5))
```

## What is the average daily activity pattern?

We'll start by making a line plot of the average number of steps for each five
minute interval.

```{r}
# Plot the average number of steps for each five minute interval
activity_data %>% group_by(interval) %>%
	summarize(avg_steps = mean(steps, na.rm = T)) %>%
	ggplot(aes(interval, avg_steps)) +
	geom_line(color = 'blue', size = 2) +
	scale_x_continuous(breaks = seq(0, 2400, 200)) +
	theme_bw() +
	labs(title = 'Average Number of Steps Taken Over Each 5 Minute Interval',
		 x = 'Intervals', y = 'Average Number of Steps') +
	theme(plot.title = element_text(hjust = 0.5))
```

From the plot we can see that the interval with the largest average number of
steps is around 830.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
